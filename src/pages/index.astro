---
import subjects from "../data/subjects.json";
import nodes from "../data/nodes.json";
import edges from "../data/edges.json";
import { computeStatuses, subjectProgress } from "../lib/graph";

const statuses = computeStatuses(nodes, edges);
---
<html>
  <head><title>Second cerveau</title></head>
  <body>
    <h1>Sujets</h1>
    <ul>
      {subjects.map((s) => {
        const p = subjectProgress(s.slug, nodes, statuses);
        const pct = Math.round(p.progress * 100);
        return (
          <li>
            <a href={`/${s.slug}/`}>{s.title}</a> â€” {pct}% ({p.mastered}/{p.total})
          </li>
        );
      })}
    </ul>
  </body>
</html>